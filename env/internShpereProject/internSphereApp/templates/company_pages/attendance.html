{% extends "main_pages/base.html" %}
{% load static %}

{% block nav_and_footer %}
<style>
    /* Same styles as before */
</style>

<div class="heading">
    <h2>Mark Attendance for Week {{ week }}</h2>
</div>

<form method="POST">
    {% csrf_token %}
    <table>
        <thead>
            <tr>
                <th>Student</th>
                {% for day in weekdays %}
                    <th>{{ day }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for student in applications %}  {# Iterate through applications #}
            <tr>
                <td>{{ student.student.user.username }}</td>  {# Access username from Student profile #}
                {% for day in weekdays %}
                    {% for week_num in weeks %}
                        <td>
                            <label>
                                <input type="radio" name="{{ student.id }}_{{ day }}_{{ week_num }}" value="Present"
                                     {% if attendance_data.get(student.student.id) and attendance_data[student.student.id][str(week_num)] == 'Present' %}
                                        checked
                                     {% endif %}
                                >
                                Present
                            </label>
                            <label>
                                <input type="radio" name="{{ student.id }}_{{ day }}_{{ week_num }}" value="Absent"
                                     {% if attendance_data.get(student.student.id) and attendance_data[student.student.id][str(week_num)] == 'Absent' %}
                                        checked
                                     {% endif %}
                                >
                                Absent
                            </label>
                        </td>
                    {% endfor %}
                {% endfor %}
            </tr>
            {% endfor %}
        
        </tbody>
    </table>
    <button type="submit">Save Attendance</button>
</form>

{% endblock nav_and_footer %}
